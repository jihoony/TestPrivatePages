<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="turbo-root" content="/TestPrivatePages">
    <meta name="turbo-cache-control" content="no-cache">

    <!-- Primary Meta Tags -->
    <title>OpenSSL</title>
    <meta name="title" content="OpenSSL">
    <meta name="description" content="RHEL/CentOS Linux는 기본 패키지에 포함되어 있으므로 별도 설치를 안해도 됩니다." />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://jihoony.github.io/TestPrivatePages/openssl/">
    <meta property="og:title" content="OpenSSL">
    <meta property="og:description" content="RHEL/CentOS Linux는 기본 패키지에 포함되어 있으므로 별도 설치를 안해도 됩니다.">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://jihoony.github.io/TestPrivatePages/openssl/">
    <meta property="twitter:title" content="OpenSSL">
    <meta property="twitter:description" content="RHEL/CentOS Linux는 기본 패키지에 포함되어 있으므로 별도 설치를 안해도 됩니다.">
    
    <script>(function () { var el = document.documentElement, m = localStorage.getItem("/TestPrivatePages/doc_theme"), wm = window.matchMedia; if (m === "dark" || (!m && wm && wm("(prefers-color-scheme: dark)").matches)) { el.classList.add("dark") } else { el.classList.remove("dark") } })();</script>

    <link href="/TestPrivatePages/resources/css/retype.css?v=1.11.1.693552519383" rel="stylesheet" data-turbo-track="reload" />

    <script type="text/javascript" src="/TestPrivatePages/resources/js/config.js?v=1.11.1.693552519383" defer data-turbo-track="reload"></script>
    <script type="text/javascript" src="/TestPrivatePages/resources/js/retype.js?v=1.11.1" defer data-turbo-track="reload"></script>
    <script id="lunr-js" type="text/javascript" src="/TestPrivatePages/resources/js/lunr.js?v=1.11.1.693552519383" defer></script>
    <script id="prism-js" type="text/javascript" src="/TestPrivatePages/resources/js/prism.js?v=1.11.1.693552519383" defer></script>
</head>
    <body>
        <div id="docs-app" class="relative text-base antialiased text-gray-700 bg-white font-body dark:bg-dark-850 dark:text-dark-300">
    <div class="absolute bottom-0 left-0 bg-gray-100 dark:bg-dark-800" style="top: 5rem; right: 50%"></div>

    <header id="docs-site-header" class="sticky top-0 z-30 flex w-full h-16 bg-white border-b border-gray-200 md:h-20 dark:bg-dark-850 dark:border-dark-650">
    <div class="container relative flex items-center justify-between flex-grow pr-6 md:justify-start">
        <!-- Mobile menu button skeleton -->
        <button v-cloak class="skeleton docs-mobile-menu-button flex items-center justify-center flex-shrink-0 overflow-hidden dark:text-white focus:outline-none rounded-full w-10 h-10 ml-3.5 md:hidden"><svg xmlns="http://www.w3.org/2000/svg" class="mb-px flex-shrink-0" width="24" height="24" viewBox="0 0 24 24" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor"><path d="M2 4h20v2H2zM2 11h20v2H2zM2 18h20v2H2z"></path></g></svg></button>
        <div v-cloak id="docs-sidebar-toggle"></div>

        <!-- Logo -->
        <div class="flex items-center justify-between h-full py-2 md:w-75">
            <div class="flex items-center px-2 md:px-6">
                <a id="docs-site-logo" href="/TestPrivatePages/" class="flex items-center leading-snug text-2xl">
                    <span class="dark:text-white font-semibold line-clamp-1 md:line-clamp-2">Project Name</span>
                </a><span class="hidden px-2 py-1 ml-4 text-sm font-semibold leading-none text-root-logo-label-text bg-root-logo-label-bg rounded-sm md:inline-block">Docs</span>
            </div>

            <span class="hidden h-8 border-r md:inline-block dark:border-dark-650"></span>
        </div>

        <div class="flex justify-between md:flex-grow">
            <!-- Top Nav -->
            <nav class="hidden md:flex">
    <ul class="flex flex-col mb-4 md:pl-16 md:mb-0 md:flex-row md:items-center">
        <li class="md:mr-6">
            <a class="block py-2 text-sm text-gray-400 whitespace-nowrap transition-colors duration-200 ease-linear md:text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200 md:mb-0" href="https://retype.com/guides/getting-started/">Getting Started</a>
        </li>
    </ul>
</nav>

            <!-- Header Right Skeleton -->
            <div v-cloak class="flex justify-end flex-grow skeleton">

                <!-- Search input mock -->
                <div class="relative hidden w-40 lg:block lg:max-w-sm lg:ml-auto">
                    <div class="absolute flex items-center justify-center h-full pl-3 dark:text-dark-300">
                        <svg xmlns="http://www.w3.org/2000/svg" class="icon-base" width="16" height="16" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation"  style="margin-bottom: 1px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                    </div>

                    <input class="w-full h-10 transition-colors duration-200 ease-in bg-gray-200 border border-transparent rounded md:text-sm hover:bg-white hover:border-gray-300 focus:outline-none focus:bg-white focus:border-gray-500 dark:bg-dark-600 dark:border-dark-600 placeholder-gray-400 dark:placeholder-dark-400"
                    style="padding: 0.625rem 0.75rem 0.625rem 2rem" type="text" placeholder="Search" />
                </div>

                <!-- Mobile search button mock -->
                <div class="flex items-center justify-center w-10 h-10 lg:hidden">
                    <svg xmlns="http://www.w3.org/2000/svg" class="flex-shrink-0 icon-base" width="20" height="20" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation"  style="margin-bottom: 0px;"><g fill="currentColor" ><path d="M21.71 20.29l-3.68-3.68A8.963 8.963 0 0020 11c0-4.96-4.04-9-9-9s-9 4.04-9 9 4.04 9 9 9c2.12 0 4.07-.74 5.61-1.97l3.68 3.68c.2.19.45.29.71.29s.51-.1.71-.29c.39-.39.39-1.03 0-1.42zM4 11c0-3.86 3.14-7 7-7s7 3.14 7 7c0 1.92-.78 3.66-2.04 4.93-.01.01-.02.01-.02.01-.01.01-.01.01-.01.02A6.98 6.98 0 0111 18c-3.86 0-7-3.14-7-7z" ></path></g></svg>
                </div>

                <!-- Dark mode switch placehokder -->
                <div class="w-10 h-10 lg:ml-2"></div>

                <!-- History button mock -->
                <div class="flex items-center justify-center w-10 h-10" style="margin-right: -0.625rem;">
                    <svg xmlns="http://www.w3.org/2000/svg" class="flex-shrink-0 icon-base" width="22" height="22" viewBox="0 0 24 24" aria-labelledby="icon" role="presentation"  style="margin-bottom: 0px;"><g fill="currentColor" ><g ><path d="M12.01 6.01c-.55 0-1 .45-1 1V12a1 1 0 00.4.8l3 2.22a.985.985 0 001.39-.2.996.996 0 00-.21-1.4l-2.6-1.92V7.01c.02-.55-.43-1-.98-1z"></path><path d="M12.01 1.91c-5.33 0-9.69 4.16-10.05 9.4l-.29-.26a.997.997 0 10-1.34 1.48l1.97 1.79c.19.17.43.26.67.26s.48-.09.67-.26l1.97-1.79a.997.997 0 10-1.34-1.48l-.31.28c.34-4.14 3.82-7.41 8.05-7.41 4.46 0 8.08 3.63 8.08 8.09s-3.63 8.08-8.08 8.08c-2.18 0-4.22-.85-5.75-2.4a.996.996 0 10-1.42 1.4 10.02 10.02 0 007.17 2.99c5.56 0 10.08-4.52 10.08-10.08.01-5.56-4.52-10.09-10.08-10.09z"></path></g></g></svg>
                </div>
            </div>

            <div v-cloak class="flex items-center justify-end flex-grow">
                <div id="docs-mobile-search-button"></div>
                <doc-search-desktop></doc-search-desktop>

                <doc-theme-switch class="lg:ml-2"></doc-theme-switch>
                <doc-history></doc-history>
            </div>
        </div>
    </div>
</header>


    <div class="container relative flex bg-white">
        <!-- Sidebar Skeleton -->
<div v-cloak class="fixed flex flex-col flex-shrink-0 duration-300 ease-in-out bg-gray-100 border-gray-200 sidebar top-20 w-75 border-r h-screen md:sticky transition-transform skeleton dark:bg-dark-800 dark:border-dark-650">

    <!-- Render this div, if config.showSidebarFilter is `true` -->
    <div class="flex items-center h-16 px-6">
        <input class="w-full h-8 px-3 py-2 transition-colors duration-200 ease-linear bg-white border border-gray-200 rounded shadow-none text-sm focus:outline-none focus:border-gray-600 dark:bg-dark-600 dark:border-dark-600" type="text" placeholder="Filter" />
    </div>

    <div class="pl-6 mb-4 mt-1">
        <div class="w-32 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
        <div class="w-48 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
        <div class="w-40 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
        <div class="w-32 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
        <div class="w-48 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
        <div class="w-40 h-3 mb-4 bg-gray-200 rounded-full loading dark:bg-dark-600"></div>
    </div>


    <div class="flex-shrink-0 mt-auto bg-transparent dark:border-dark-650">
        <a
    class="flex items-center justify-center flex-nowrap h-16 text-gray-400 dark:text-dark-400 hover:text-gray-700 dark:hover:text-dark-300 transition-colors duration-150 ease-in docs-powered-by"
    target="_blank"
    href="https://retype.com/"
    rel="noopener"
>
    <span class="text-xs whitespace-nowrap">Powered by</span>
    <svg xmlns="http://www.w3.org/2000/svg" class="ml-2" fill="currentColor" width="96" height="20" overflow="visible"><path d="M0 0v20h13.59V0H0zm11.15 17.54H2.44V2.46h8.71v15.08zM15.8 20h2.44V4.67L15.8 2.22zM20.45 6.89V20h2.44V9.34z"/><g><path d="M40.16 8.44c0 1.49-.59 2.45-1.75 2.88l2.34 3.32h-2.53l-2.04-2.96h-1.43v2.96h-2.06V5.36h3.5c1.43 0 2.46.24 3.07.73s.9 1.27.9 2.35zm-2.48 1.1c.26-.23.38-.59.38-1.09 0-.5-.13-.84-.4-1.03s-.73-.28-1.39-.28h-1.54v2.75h1.5c.72 0 1.2-.12 1.45-.35zM51.56 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92h4.74v1.83h-6.79V5.36h6.64zM60.09 7.15v7.48h-2.06V7.15h-2.61V5.36h7.28v1.79h-2.61zM70.81 14.64h-2.06v-3.66l-3.19-5.61h2.23l1.99 3.45 1.99-3.45H74l-3.19 5.61v3.66zM83.99 6.19c.65.55.97 1.4.97 2.55s-.33 1.98-1 2.51-1.68.8-3.04.8h-1.23v2.59h-2.06V5.36h3.26c1.42 0 2.45.28 3.1.83zm-1.51 3.65c.25-.28.37-.69.37-1.22s-.16-.92-.48-1.14c-.32-.23-.82-.34-1.5-.34H79.7v3.12h1.38c.68 0 1.15-.14 1.4-.42zM95.85 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92H96v1.83h-6.79V5.36h6.64z"/></g></svg>
</a>

    </div>
</div>

<!-- Sidebar component -->
<doc-sidebar v-cloak>
    <template #sidebar-footer>
        <div
            class="flex-shrink-0 mt-auto border-t md:bg-transparent md:border-none dark:border-dark-650"
        >

            <div class="py-3 px-6 md:hidden border-b dark:border-dark-650">
                <nav>
                    <ul class="flex flex-wrap justify-center items-center">
                        <li class="mr-6">
                            <a class="block py-1 text-sm whitespace-nowrap transition-colors duration-200 ease-linear text-blue-500 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200" href="https://retype.com/guides/getting-started/">Getting Started</a>
                        </li>
                    </ul>
                </nav>
            </div>


            <a
    class="flex items-center justify-center flex-nowrap h-16 text-gray-400 dark:text-dark-400 hover:text-gray-700 dark:hover:text-dark-300 transition-colors duration-150 ease-in docs-powered-by"
    target="_blank"
    href="https://retype.com/"
    rel="noopener"
>
    <span class="text-xs whitespace-nowrap">Powered by</span>
    <svg xmlns="http://www.w3.org/2000/svg" class="ml-2" fill="currentColor" width="96" height="20" overflow="visible"><path d="M0 0v20h13.59V0H0zm11.15 17.54H2.44V2.46h8.71v15.08zM15.8 20h2.44V4.67L15.8 2.22zM20.45 6.89V20h2.44V9.34z"/><g><path d="M40.16 8.44c0 1.49-.59 2.45-1.75 2.88l2.34 3.32h-2.53l-2.04-2.96h-1.43v2.96h-2.06V5.36h3.5c1.43 0 2.46.24 3.07.73s.9 1.27.9 2.35zm-2.48 1.1c.26-.23.38-.59.38-1.09 0-.5-.13-.84-.4-1.03s-.73-.28-1.39-.28h-1.54v2.75h1.5c.72 0 1.2-.12 1.45-.35zM51.56 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92h4.74v1.83h-6.79V5.36h6.64zM60.09 7.15v7.48h-2.06V7.15h-2.61V5.36h7.28v1.79h-2.61zM70.81 14.64h-2.06v-3.66l-3.19-5.61h2.23l1.99 3.45 1.99-3.45H74l-3.19 5.61v3.66zM83.99 6.19c.65.55.97 1.4.97 2.55s-.33 1.98-1 2.51-1.68.8-3.04.8h-1.23v2.59h-2.06V5.36h3.26c1.42 0 2.45.28 3.1.83zm-1.51 3.65c.25-.28.37-.69.37-1.22s-.16-.92-.48-1.14c-.32-.23-.82-.34-1.5-.34H79.7v3.12h1.38c.68 0 1.15-.14 1.4-.42zM95.85 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92H96v1.83h-6.79V5.36h6.64z"/></g></svg>
</a>

        </div>
    </template>
</doc-sidebar>


        <div class="flex-grow min-w-0 dark:bg-dark-850">
            <!-- Render "toolbar" template here on api pages --><!-- Render page content -->
            <div class="flex">
    <div class="flex-grow min-w-0 px-6 md:px-16">
        <main class="relative pt-6 pb-16">
            <div class="docs-markdown" id="docs-content">
                <!-- Rendered if sidebar right is enabled -->
                <div id="docs-sidebar-right-toggle"></div>
               
                <!-- Page content  -->
<doc-anchor-target id="openssl" class="break-words">
    <h1>
        <doc-anchor-trigger class="header-anchor-trigger" to="#openssl">#</doc-anchor-trigger>
        <span>OpenSSL</span>
    </h1>
</doc-anchor-target>
<doc-anchor-target id="openssl-자주-쓰는-명령어command-및-사용법-tip-정리">
    <h1>
        <doc-anchor-trigger class="header-anchor-trigger" to="#openssl-자주-쓰는-명령어command-및-사용법-tip-정리">#</doc-anchor-trigger>
        <span>OpenSSL 자주 쓰는 명령어(command) 및 사용법, tip 정리</span>
    </h1>
</doc-anchor-target>
<doc-anchor-target id="설치">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#설치">#</doc-anchor-trigger>
        <span>설치</span>
    </h2>
</doc-anchor-target>
<p>RHEL/CentOS Linux는 기본 패키지에 포함되어 있으므로 별도 설치를 안해도 됩니다.</p>
<p>설치된 openssl의 version은 다음 명령어로 확인할수 있습니다.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ openssl version

OpenSSL 1.0.2o 27 Mac 2018</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="인증서-정보-보기">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#인증서-정보-보기">#</doc-anchor-trigger>
        <span>인증서 정보 보기</span>
    </h2>
</doc-anchor-target>
<p>openssl로 x.509 certificate를 parsing 하는 방법</p>
<doc-anchor-target id="파싱-및-정보-보기">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#파싱-및-정보-보기">#</doc-anchor-trigger>
        <span>파싱 및 정보 보기</span>
    </h3>
</doc-anchor-target>
<p>PEM 인코딩된 x.509 인증서를 파싱해서 정보 출력</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ openssl x509 -text -noout -in localhost.crt</code></pre>
</doc-codeblock></div>
<p>텍스트가 아닌 바이너리(DER 인코딩)일 경우 <em>-inform der</em> 옵션 추가</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ openssl x509 -inform der -text -noout -in localhost.crt</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="인코딩-변환">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#인코딩-변환">#</doc-anchor-trigger>
        <span>인코딩 변환</span>
    </h3>
</doc-anchor-target>
<doc-anchor-target id="der---pem">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#der---pem">#</doc-anchor-trigger>
        <span>DER -&gt; PEM</span>
    </h4>
</doc-anchor-target>
<p>DER 인코딩된 인증서를 PEM으로 변경</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ openssl x509 -inform der -outform pem -out mycert.pem -in mycert.der</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="pem---der">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#pem---der">#</doc-anchor-trigger>
        <span>PEM -&gt; DER</span>
    </h4>
</doc-anchor-target>
<p>PEM 형식 인증서를 DER로 인코딩해서 저장</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ openssl x509 -inform pem -outform der -out mycert.der -in mycert.pem</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="개인키privatekey">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#개인키privatekey">#</doc-anchor-trigger>
        <span>개인키(PrivateKey)</span>
    </h2>
</doc-anchor-target>
<doc-anchor-target id="rsa2048-키-생성-및-개인키를-aes256으로-암호화">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#rsa2048-키-생성-및-개인키를-aes256으로-암호화">#</doc-anchor-trigger>
        <span>RSA2048 키 생성 및 개인키를 AES256으로 암호화</span>
    </h3>
</doc-anchor-target>
<ul>
<li>암호(pass phrase)는 asdfasdf 이며 입력창을 띄우지 않고 커맨드에서 바로 설정(<em>-passout</em> 옵션)</li>
</ul>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ openssl genrsa -aes257 -passout pass:asdfasdf -out aes-pri.pem 2048</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="위에서-생성한-개인키-복호화-하여-rsa-private-key-추출">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#위에서-생성한-개인키-복호화-하여-rsa-private-key-추출">#</doc-anchor-trigger>
        <span>위에서 생성한 개인키 복호화 하여 RSA Private Key 추출</span>
    </h4>
</doc-anchor-target>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ openssl rsa -outform der -in aes-pri.pem -passin pass:asdfasdf -out aes-pri.key</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="pass-phrase와-암호화-알고리즘-변경">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#pass-phrase와-암호화-알고리즘-변경">#</doc-anchor-trigger>
        <span>pass phrase와 암호화 알고리즘 변경</span>
    </h4>
</doc-anchor-target>
<ul>
<li>알고리즘: Triple DES -&gt; AES256</li>
<li>Pass phrase: asdfasdf -&gt; new-password</li>
</ul>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ openssl rsa -aes256 -in aes-pri.pem -passin pass:asdfasdf -passout pass:new-password -out aes-pri.key</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="개인키privatekey-pass-phrase-해독-및-설정">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#개인키privatekey-pass-phrase-해독-및-설정">#</doc-anchor-trigger>
        <span>개인키(PrivateKey) pass phrase 해독 및 설정</span>
    </h3>
</doc-anchor-target>
<p>보안에 취약할 수 있지만 어쩔수 없이 개인키를 암호(pass phrase)없이 사용해야 하는 경우가 종종 있습니다.</p>
<p>예로 비용때문에 AWS CloudFront나 Load Balancer를 사용하지 않고 직접 EC2나 On-Premise 서버에서 웹 서버를 설치하고 SSL/TLS를 설정할 경우 개인키 암호가 있으면 웹 서버 재구동시마다 입력이 필요하므로 서버 리부팅등시 문제가 됩니다.</p>
<p>이럴 경우 다음 openssl 명령어로 개인키를 해독해서 저장하면 pass phrase 입력없이 개인키를 사용할 수 있습니다.</p>
<doc-anchor-target id="pass-phrase-해독">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#pass-phrase-해독">#</doc-anchor-trigger>
        <span>Pass phrase 해독</span>
    </h4>
</doc-anchor-target>
<p>/etc/pki/tls/private/examplelocalhost.key/enc 라는 암호화된 개인키가 있을 경우 다음 openssl 명령어로 해독할 수 있습니다.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ openssl rsa -in /etc/pki/tls/private/example.com.key.enc -out /etc/pki/tls/private/example.com.key

Enter pass phrase for /etc/pki/tls/private/example.com.key.enc:</code></pre>
</doc-codeblock></div>
<p>Enter pass phrase에 개인키에 설정한 암호를 입력해 주면 -out에 지정한 경로에 복호화된 개인키가 저장됩니다.</p>
<p>보안때문에 권장하지는 않지만 -passin pass:mypwd옵션으로 명령행에서 바로 pass phrase를 입력할 수 있습니다.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ openssl rsa -in /etc/pki/tls/private/example.com.key.enc -out /etc/pki/tls/private/example.com.key -passin pass:secret123</code></pre>
</doc-codeblock></div>
<blockquote>
<p>사전에 copy 명령어로 개인키 백업을 권장합니다.</p>
</blockquote>
<doc-anchor-target id="pass-phrase-설정">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#pass-phrase-설정">#</doc-anchor-trigger>
        <span>Pass phrase 설정</span>
    </h4>
</doc-anchor-target>
<p>반대로 다음 openssl 명령어로 AES256 으로 개인키 파일인 example.com.key 를 암호화해서 example.com.key.enc로 저장할 수 있습니다.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ openssl rsa -aes256 -in example.com.key  -out example.com.key.enc</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="pass-phrase-설정-여부-확인">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#pass-phrase-설정-여부-확인">#</doc-anchor-trigger>
        <span>Pass phrase 설정 여부 확인</span>
    </h4>
</doc-anchor-target>
<p>개인키가 암호화 되었는지 여부는 간단하게 사용하는 에디터로 개인키 파일을 열고 다음과 같이 Proc-Type 구분이 앞에 있는지 확인하면 됩니다.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<div class="codeblock-title">PEM</div>
<pre class="language-none"><code v-pre class="language-none">-----BEGIN RSA PRIVATE KEY-----
Proc-Type: 4,ENCRYPTED
DEK-Info: AES-256-CBC,9BF3ACA724D1187B19BDDB1585687E8A</code></pre>
</doc-codeblock></div>
<ul>
<li>Proc-Type: 개인키가 암호화 되었음을 나타냅니다.</li>
<li>DEK-Info: 암호화 알고리즘을 표시하며 AES 방식의 256 bit key 를 사용하며 CBC 운영 모드를 사용합니다.</li>
</ul>
<p>암호화되지 않은 개인키를 바로 아래와 같은 구문으로 시작되므로 구분할 수 있습니다.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<div class="codeblock-title">PEM</div>
<pre class="language-none"><code v-pre class="language-none">-----BEGIN RSA PRIVATE KEY-----
MIIEogIBAAKCAQEAtHyN+f/vS6mb</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="pass-phrase-란">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#pass-phrase-란">#</doc-anchor-trigger>
        <span>Pass phrase 란?</span>
    </h4>
</doc-anchor-target>
<p>일반적으로 어떤 시스템이나 자원에 접근하기 위한 패스워드(password)를 비밀번호로 번역합니다. 숫자만 암호로 사용했던 예전에는 맞지만 알파벳과 특수문자를 조합할 수 있는 지금은 비밀번호보다는 pass phrase라는 단어가 더 정확합니다.</p>
<doc-anchor-target id="pkcs8-방식의-개인키-해독">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#pkcs8-방식의-개인키-해독">#</doc-anchor-trigger>
        <span>pkcs#8 방식의 개인키 해독</span>
    </h3>
</doc-anchor-target>
<p><a href="http://www.ietf.org/rfc/rfc5208.txt">Private-Key Information Syntax Specification</a> 방식으로 암호화된 RSA PrivateKey 를 해독하려면 아래 명령을 사용합니다.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ openssl pkcs8 -inform der -in pkcs8-pri.key -out rsa-pri.key</code></pre>
</doc-codeblock></div>
<p>PKCS#8 파일은 binary 형식(DER) 과 text 형식(PEM) 이 있을 수 있으며 에디터로 열었을 때 -----BEGIN ENCRYPTED PRIVATE KEY----- 로 시작하는 경우 PEM 이며 깨지는 문자가 있을 경우 DER 입니다.</p>
<p>&lt; PKCS8 PEM 예제 &gt;</p>
<div class="codeblock-wrapper"><doc-codeblock>
<div class="codeblock-title">PEM</div>
<pre class="language-none"><code v-pre class="language-none">-----BEGIN ENCRYPTED PRIVATE KEY-----
MIIFHzBJBgkqhkiG9w0BBQ0wPDAbBgkqhkiG9w0BBQwwDgQITJWLw/UHoM0CAggA</code></pre>
</doc-codeblock></div>
<p>PEM 형식일 경우 <em>-inform der</em> 구문대신 <em>-inform pem</em> 을 사용하면 됩니다.</p>
<doc-anchor-target id="pkcs8-로-변환">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#pkcs8-로-변환">#</doc-anchor-trigger>
        <span>pkcs#8 로 변환</span>
    </h3>
</doc-anchor-target>
<p>개인키의 pass phrase 를 PKCS#8 형식으로 변환</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ openssl pkcs8 -topk8 -v2 aes128 -in aes-pri.pem -out aes-strong.key -outform der -passout pass:asdfasdf</code></pre>
</doc-codeblock></div>
<ul>
<li>-topk8 : output PKCS8 file</li>
<li>-v2 aes128 : PKCS#5 Ver 2.0 사용 및 aes128 사용</li>
</ul>
<doc-anchor-target id="https-연결의-인증서-디버깅">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#https-연결의-인증서-디버깅">#</doc-anchor-trigger>
        <span>HTTPS 연결의 인증서 디버깅</span>
    </h3>
</doc-anchor-target>
<p>HTTPS 디버깅(httpd 의 SSLCertificateChainFile, SSLCACertificateFile 정상 설정 여부 확인등)이나 curl 등의 ca bundle 에 등록하기 위한 목적으로 서버가 사용하는 SSL 인증서를 추출할 경우 아래 명령어 사용</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ openssl s_client -debug -connect ssl.example.com:443</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="cmspkcs7-smime">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#cmspkcs7-smime">#</doc-anchor-trigger>
        <span>CMS(PKCS#7, S/MIME)</span>
    </h2>
</doc-anchor-target>
<p><strong>cms(Cryptographic Message Syntax)</strong> 명령어는 S/MIME v3.1 mail 이나 PKCS#7 형식의 데이타를 처리하는 명령어로 주요 옵션은 다음과 같다.</p>
<ul>
<li><strong>-verify</strong> : 전자서명 검증 수행</li>
<li><strong>-in</strong> : 검증할 전자서명 데이타 파일</li>
<li><strong>-certfile</strong> : 검증에 사용할 인증서 파일(전자 서명 데이타내에 인증서가 없을 경우 필요 - 생성시 -nocerts 으로 생성했을 경우)</li>
<li><strong>-out</strong> : 검증후 원본을 저장할 파일명</li>
<li><strong>-content</strong> : 검증에 사용할 원본 파일</li>
<li><strong>-CAfile</strong> : 인증서 발급 체인(CA 인증서 묶음. PEM 형식으로 연접해서 작성해 주면 되며 예제는 curl 에 포함된 ca인증서 번들 파일 참고 - /etc/pki/tls/certs/ca-bundle.crt)</li>
</ul>
<doc-anchor-target id="signeddata-검증">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#signeddata-검증">#</doc-anchor-trigger>
        <span>signeddata 검증</span>
    </h3>
</doc-anchor-target>
<p>DER 로 인코딩된 cms signed-data 형식인 inputfile 을 검증하고 원본을 content 라는 파일로 저장</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ openssl cms -verify -in signedData.ber -inform DER  -out content</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="인증서-체인-지정">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#인증서-체인-지정">#</doc-anchor-trigger>
        <span>인증서 체인 지정</span>
    </h3>
</doc-anchor-target>
<p>signed-data 안에 인증서 체인이 없을 경우 다음과 같은 에러가 발생한다</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ certificate verify error:cms_smime.c:304:Verify error:unable to get local issuer certificate</code></pre>
</doc-codeblock></div>
<p>CA 인증서를 PEM 형식의 파일(Ex: ca-file) 으로 만든 후에  <strong>-CAfile file</strong> 옵션을 추가하면 검증시 사용할 CA 인증서를 지정해 줄 수 있다.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ openssl cms -verify -in signedData.ber -inform DER  -out content -CAfile ca-file</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="detached-signeddata-검증">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#detached-signeddata-검증">#</doc-anchor-trigger>
        <span>detached signeddata 검증</span>
    </h3>
</doc-anchor-target>
<p>서명에 사용된 컨텐츠가 CMS Signed Data 내에 없거나 또는 있어도 강제로 외부 파일을 사용할 경우 -content file 옵션으로 파일을 지정하면 된다.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ openssl cms -verify -in signedData.ber -inform DER  -out content -CAfile ca-file -content origFile</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="signeddata-생성">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#signeddata-생성">#</doc-anchor-trigger>
        <span>signeddata 생성</span>
    </h3>
</doc-anchor-target>
<p>PEM 형식으로 된 인증서와 개인키를 사용하여 전자 서명 데이타 생성</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ openssl cms  -sign -in contents.pdf -aes128 -nosmimecap -signer sign-cert.pem -inkey sign-key.pem -outform DER -nodetach  -out signed-data.ber</code></pre>
</doc-codeblock></div>
<ul>
<li><strong>-sign</strong> : 전자 서명 데이타 생성</li>
<li><strong>-in</strong> : 전자서명할 원본 데이타</li>
<li><strong>-nodetach</strong>:  전자서명 데이타에 원본 첨부</li>
<li><strong>-nosmimecap</strong>:</li>
<li><strong>-noattr</strong>: 전자서명 데이타에 어떤 signed attributes 도 포함하지 않음.</li>
</ul>
<doc-anchor-target id="envelop--data-생성">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#envelop--data-생성">#</doc-anchor-trigger>
        <span>envelop  data 생성</span>
    </h3>
</doc-anchor-target>
<p>CMS envelopedData data 생성(대칭키를 생성후 원본을 암호화한 후에 상대방 인증서의 공개키로 대칭키를 암호한 데이타 형식)</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ openssl cms -encrypt -in contents.pdf -aes256 -recip sign-cert.pem -outform DER -out enveloped-data.ber</code></pre>
</doc-codeblock></div>
<ul>
<li><strong>-encrypt</strong>: encrypt 데이타 생성</li>
<li><strong>-in</strong> : 암호화할 원본 데이타</li>
<li><strong>-aes256</strong> : AES256 으로 암호화(-aes128, -seed, -camellia128 등의 알고리즘 사용 가능)</li>
<li><strong>-recip</strong>: 데이타를 수신할 상대방의 인증서(이 안에 있는 공개키로 암호화하므로 상대방 인증서를 정확히 넣어주어야 함)</li>
</ul>
<doc-anchor-target id="envelop--data-해독">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#envelop--data-해독">#</doc-anchor-trigger>
        <span>envelop  data 해독</span>
    </h3>
</doc-anchor-target>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ openssl cms -decrypt -in enveloped-data.ber -inform der -inkey kmpri.pem</code></pre>
</doc-codeblock></div>
<ul>
<li>-decrypt : 1123</li>
<li>-in : 해독할 enveloped data 파일</li>
<li>-inform : 파일의 포맷. 기본값은 PEM 이며 der 인코딩되었을 경우 der 추가</li>
<li>-inkey: 복호화할 개인키</li>
</ul>
<blockquote>
<p>-decrypt 시 -out 옵션이 통하지 않으므로 &gt; 로 원본 파일을 저장해야 함</p>
<p>openssl cms -decrypt -in enveloped-data.ber -inform der -inkey kmpri.pem &gt; contents</p>
</blockquote>
<doc-anchor-target id="pkcs12">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#pkcs12">#</doc-anchor-trigger>
        <span>PKCS#12</span>
    </h2>
</doc-anchor-target>
<doc-anchor-target id="check-a-certificate-signing-request-csr---pkcs10">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#check-a-certificate-signing-request-csr---pkcs10">#</doc-anchor-trigger>
        <span>Check a Certificate Signing Request (CSR) - PKCS#10</span>
    </h3>
</doc-anchor-target>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ openssl req -text -noout -verify -in CSR.csr</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="pkcs12-생성">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#pkcs12-생성">#</doc-anchor-trigger>
        <span>pkcs12 생성</span>
    </h3>
</doc-anchor-target>
<doc-anchor-target id="pkcs12-생성-1">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#pkcs12-생성-1">#</doc-anchor-trigger>
        <span>pkcs12 생성</span>
    </h4>
</doc-anchor-target>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ openssl pkcs12 -export -in cert.pem -inkey pri-key.pem -out file.p12 -name &quot;My Certificate&quot;</code></pre>
</doc-codeblock></div>
<ul>
<li>-export : PKCS#12 파일 생성</li>
<li>-in : p12 에 들어갈 인증서</li>
<li>-inkey: 포함시킬 개인키</li>
<li>-out : 생성될 p12 파일명</li>
<li>-name: riendlyName 에 들어갈 이름이며 Java 에서 KeyStore 로 접근시 alias 항목이 되므로 필수로 입력해야 한다. openssl 은 입력되지 않았을 경우 인증서의 해시값을 설정하는 것 같다.</li>
<li>-descert :  p12 내 인증서 항목을 Triple DES 로 암호화(기본값 RC2-40) - 인증서는 공개하는 용도이므로 크게 의미 없는 옵션</li>
<li>-des3 : encrypt private keys with triple DES (default)</li>
<li>-aes128 : 개인키를 AES128 로 암호화(권장)</li>
<li>-keypbe alg: specify private key PBE algorithm (default 3DES)</li>
</ul>
<doc-anchor-target id="기타-인증서를-포함하여-p12-생성">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#기타-인증서를-포함하여-p12-생성">#</doc-anchor-trigger>
        <span>기타 인증서를 포함하여 p12 생성</span>
    </h4>
</doc-anchor-target>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ openssl pkcs12 -export -in cert.pem -inkey pri-key.pem -out file.p12 -name &quot;My Certificate&quot; -certfile othercerts.pem</code></pre>
</doc-codeblock></div>
<ul>
<li>-certifile: 포함시킬 추가 인증서</li>
</ul>
<doc-anchor-target id="check-a-pkcs12-file-pfx-or-p12">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#check-a-pkcs12-file-pfx-or-p12">#</doc-anchor-trigger>
        <span>Check a PKCS#12 file (.pfx or .p12)</span>
    </h3>
</doc-anchor-target>
<p>PKCS#12 정보 출력</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ openssl pkcs12 -info -in keyStore.p12</code></pre>
</doc-codeblock></div>
<p>PKCS#12 내 인증서를 파일로 저장(-clcerts -nokeys)</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ openssl pkcs12 -in file.p12 -clcerts -nokeys -out file.crt</code></pre>
</doc-codeblock></div>
<p>PKCS#12 내 개인키를 파일로 저장</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ openssl pkcs12 -in file.p12 -nocerts -out file.key</code></pre>
</doc-codeblock></div>
<p>PKCS#12 내 개인키에 pass phrase 를 적용하지 않고 파일로 저장</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ openssl pkcs12 -in file.p12 -out file.pem -nodes</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="ocsp">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#ocsp">#</doc-anchor-trigger>
        <span>OCSP</span>
    </h2>
</doc-anchor-target>
<blockquote>
<p>인증서는 PEM 형식이어야 함.</p>
</blockquote>
<doc-anchor-target id="ocsprequest-생성">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#ocsprequest-생성">#</doc-anchor-trigger>
        <span>OCSPRequest 생성</span>
    </h3>
</doc-anchor-target>
<p>lesstif.cer 인증서를 검증하기 위한 OCSPRequest 를 생성하여 파일(ocsp-req.ber)로 저장. -issuer 옵션에는 인증기관 인증서를 입력</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ openssl ocsp -issuer myca.cer -cert lesstif.cer -reqout ocsp-req.ber </code></pre>
</doc-codeblock></div>
<doc-anchor-target id="ocsp-로-인증서-검증">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#ocsp-로-인증서-검증">#</doc-anchor-trigger>
        <span>ocsp 로 인증서 검증</span>
    </h3>
</doc-anchor-target>
<p>위에서 생성한 OCSPRequest 를 읽어서 -url 로 지정된 OCSP 서버에서 인증서 검증 요청</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ openssl ocsp -reqin ocsp-req.ber -text -url http://myocsp.server.com:8080/ocsp</code></pre>
</doc-codeblock></div>
<p>검증할 인증서를 읽어서 검증 요청</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ openssl ocsp -issuer myca.cer -cert lesstif.cer  -text -url http://myocsp.server.com:8080/ocsp</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="ocsp-asn-파싱">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#ocsp-asn-파싱">#</doc-anchor-trigger>
        <span>ocsp asn 파싱</span>
    </h3>
</doc-anchor-target>
<p>-reqin 으로 지정된 파일로부터 OCSPRequest 형식의 데이타를 읽어서 출력</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ openssl ocsp -reqin ocsp-req.ber -text

OCSP Request Data:
    Version: 1 (0x0)
    Requestor List:
        Certificate ID:
          Hash Algorithm: sha1
          Issuer Name Hash: D530654290FA7C42771A7566518BB1420AB04CE0
          Issuer Key Hash: 4D5D560A0703DF83CAF3D56D8F19FC12AC90A28A
          Serial Number: 598E19F6
    Request Extensions:
        OCSP Nonce: 
            0410D8F5A2A55605873CBEBB043FCA79022A</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="tsatime-stamp-authority">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#tsatime-stamp-authority">#</doc-anchor-trigger>
        <span>TSA(Time Stamp Authority)</span>
    </h2>
</doc-anchor-target>
<doc-anchor-target id="ts-생성">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#ts-생성">#</doc-anchor-trigger>
        <span>ts 생성</span>
    </h3>
</doc-anchor-target>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ openssl ts -query -data mydata.txt -no_nonce -sha1 -out design1.tsq  </code></pre>
</doc-codeblock></div>
<doc-anchor-target id="print">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#print">#</doc-anchor-trigger>
        <span>print</span>
    </h3>
</doc-anchor-target>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ openssl ts -query -in design1.tsq -text</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="asn1parse">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#asn1parse">#</doc-anchor-trigger>
        <span>ASN1Parse</span>
    </h2>
</doc-anchor-target>
<doc-anchor-target id="utf8string-생성">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#utf8string-생성">#</doc-anchor-trigger>
        <span>UTF8String 생성</span>
    </h3>
</doc-anchor-target>
<p>UTF8String 을 생성해서 utf8string.der 파일로 저장</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ openssl asn1parse -genstr &quot;UTF8:헬로 World&quot; -out utf8string.der</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="utf8string-file-로-부터-파싱">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#utf8string-file-로-부터-파싱">#</doc-anchor-trigger>
        <span>UTF8String file 로 부터 파싱</span>
    </h3>
</doc-anchor-target>
<p>생성된 ASN1 파일로 부터 파싱</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ openssl asn1parse -inform DER -in utf8string.der</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="utctime-생성">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#utctime-생성">#</doc-anchor-trigger>
        <span>UTCTime 생성</span>
    </h3>
</doc-anchor-target>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ openssl asn1parse -genstr &quot;UTCTIME:970909034126Z&quot; -out utctime.der</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="utctime--파싱">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#utctime--파싱">#</doc-anchor-trigger>
        <span>UTCTime  파싱</span>
    </h3>
</doc-anchor-target>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ openssl asn1parse -inform DER -in utctime.der</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="openssl로-root-ca-생성-및-ssl-인증서-발급">
    <h1>
        <doc-anchor-trigger class="header-anchor-trigger" to="#openssl로-root-ca-생성-및-ssl-인증서-발급">#</doc-anchor-trigger>
        <span>OpenSSL로 ROOT CA 생성 및 SSL 인증서 발급</span>
    </h1>
</doc-anchor-target>
<blockquote>
<p>간단하게 CA 를 구성하려면 openssl 을 래핑한 easy rsa 를 사용하세요.</p>
</blockquote>
<doc-anchor-target id="개요">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#개요">#</doc-anchor-trigger>
        <span>개요</span>
    </h2>
</doc-anchor-target>
<p>웹서비스에 https 를 적용할 경우 SSL 인증서를 VeriSign 이나 Thawte, GeoTrust 등에서 인증서를 발급받아야 하지만 비용이 발생하므로 실제 운영 서버가 아니면 발급 받는데 부담이 될 수 있다.
이럴때 OpenSSL 을 이용하여 인증기관을 만들고 Self signed certificate 를 생성하고 SSL 인증서를 발급하는 법을 정리해 본다.
발급된 SSL 인증서는 apache httpd 등의 Web Server 에 설치하여 손쉽게 https 서비스를 제공할 수 있다.</p>
<doc-anchor-target id="self-signed-certificate-">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#self-signed-certificate-">#</doc-anchor-trigger>
        <span>Self Signed Certificate ?</span>
    </h3>
</doc-anchor-target>
<p>인증서(digital certificate)는 개인키 소유자의 공개키(public key)에 인증기관의 개인키로 전자서명한 데이타다.
모든 인증서는 발급기관(CA) 이 있어야 하나 최상위에 있는 인증기관(root ca)은 서명해줄 상위 인증기관이 없으므로 root ca의 개인키로 스스로의 인증서에 서명하여 최상위 인증기관 인증서를 만든다.
이렇게 스스로 서명한 ROOT CA 인증서를 Self Signed Certificate(SSC) 라고 부른다.
IE, FireFox, Chrome 등의 Web Browser 제작사는 VeriSign 이나 comodo 같은 유명 ROOT CA 들의 인증서를 신뢰하는 CA로 브라우저에 미리 탑재해 놓는다.
저런 기관에서 발급된 SSL 인증서를 사용해야 browser 에서는 해당 SSL 인증서를 신뢰할수 있는데 OpenSSL 로 만든 ROOT CA와 SSL 인증서는 Browser가 모르는 기관이 발급한 인증서이므로 보안 경고를 발생시킬 것이나 테스트 사용에는 지장이 없다.
ROOT CA 인증서를 Browser에 추가하여 보안 경고를 발생시키지 않으려면 Browser 에 SSL 인증서 발급기관 추가하기 를 참고하자.</p>
<doc-anchor-target id="certificate-signing-request">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#certificate-signing-request">#</doc-anchor-trigger>
        <span>Certificate Signing Request?</span>
    </h3>
</doc-anchor-target>
<p>공개키 기반(PKI)은 private key(개인키)와 public key(공개키)로 이루어져 있다.
인증서라고 하는 것은 내 공개키가 맞다고 인증기관(CA)이 전자서명하여 주는 것이며 나와 보안 통신을 하려는 당사자는 내 인증서를 구해서 그 안에 있는 공개키를 이용하여 보안 통신을 할 수 있다.
CSR(Certificate Signing Request) 은 인증기관에 인증서 발급 요청을 하는 특별한 ASN.1 형식의 파일이며(PKCS#10 - RFC2986)  그 안에는 내 공개키 정보와 사용하는 알고리즘 정보등이 들어 있다.
개인키는 외부에 유출되면 안 되므로 저런 특별한 형식의 파일을 만들어서 인증기관에 전달하여 인증서를 발급 받는다.
SSL 인증서 발급시 CSR 생성은 Web Server 에서 이루어지는데 Web Server 마다 방식이 상이하여 사용자들이 CSR 생성등을 어려워하니 인증서 발급 대행 기관에서 개인키까지 생성해서 보내주고는 한다.</p>
<doc-anchor-target id="root-ca-인증서-생성link-to-root-ca-인증서-생성">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#root-ca-인증서-생성link-to-root-ca-인증서-생성">#</doc-anchor-trigger>
        <span>ROOT CA 인증서 생성Link to ROOT CA 인증서 생성</span>
    </h2>
</doc-anchor-target>
<p>openssl 로 root ca 의 개인키와 인증서를 만들어 보자</p>
<ol>
<li><p>CA 가 사용할 RSA  key pair(public, private key) 생성</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ openssl genrsa -aes256 -out /etc/pki/tls/private/lesstif-rootca.key 2048</code></pre>
</doc-codeblock></div>
<blockquote>
<p>개인키 분실에 대비해 AES 256bit 로 암호화한다. AES 이므로 암호(pass phrase)를 분실하면 개인키를 얻을수 없으니 꼭 기억해야 한다.</p>
</blockquote>
</li>
<li><p>개인키 권한 설정</p>
<blockquote>
<p>보안 경고
개인키의 유출 방지를 위해 group 과 other의 permission 을 모두 제거한다.
chmod 600  /etc/pki/tls/private/lesstif-rootca.key</p>
</blockquote>
</li>
<li><p>CSR(Certificate Signing Request) 생성을 위한 rootca_openssl.conf 로 저장</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-properties"><code v-pre class="language-properties">[ req ]
default_bits            = 2048
default_md              = sha1
default_keyfile         = lesstif-rootca.key
distinguished_name      = req_distinguished_name
extensions             = v3_ca
req_extensions = v3_ca
 
[ v3_ca ]
basicConstraints       = critical, CA:TRUE, pathlen:0
subjectKeyIdentifier   = hash
##authorityKeyIdentifier = keyid:always, issuer:always
keyUsage               = keyCertSign, cRLSign
nsCertType             = sslCA, emailCA, objCA
[req_distinguished_name ]
countryName                     = Country Name (2 letter code)
countryName_default             = KR
countryName_min                 = 2
countryName_max                 = 2

# 회사명 입력
organizationName              = Organization Name (eg, company)
organizationName_default      = lesstif Inc.
 
# 부서 입력
#organizationalUnitName          = Organizational Unit Name (eg, section)
#organizationalUnitName_default  = Condor Project
 
# SSL 서비스할 domain 명 입력
commonName                      = Common Name (eg, your name or your server's hostname)
commonName_default             = lesstif's Self Signed CA
commonName_max                  = 64 </code></pre>
</doc-codeblock></div>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ openssl req -new -key /etc/pki/tls/private/lesstif-rootca.key -out /etc/pki/tls/certs/lesstif-rootca.csr -config rootca_openssl.conf</code></pre>
</doc-codeblock></div>
<p>아래는 OpenSSL 의 프롬프트</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter '.', the field will be left blank.
Country Name (2 letter code) [KR]:
Organization Name (eg, company) [lesstif Inc]:lesstif Inc.
Common Name (eg, your name or your servers hostname) [lesstif's Self Signed CA]:lesstif's Self Signed C</code></pre>
</doc-codeblock></div>
</li>
<li><p>10년짜리 self-signed 인증서 생성</p>
<blockquote>
<p>-extensions v3_ca 옵션을 추가해야 한다.</p>
</blockquote>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ openssl x509 -req \</code></pre>
</doc-codeblock></div>
</li>
</ol>
<p>-days 3650 <br />
-extensions v3_ca <br />
-set_serial 1 <br />
-in /etc/pki/tls/certs/lesstif-rootca.csr <br />
-signkey /etc/pki/tls/private/lesstif-rootca.key <br />
-out /etc/pki/tls/certs/lesstif-rootca.crt <br />
-extfile rootca_openssl.conf</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-none"><code v-pre class="language-none">&gt; 서명에 사용할 해시 알고리즘을 변경하려면 -sha256, -sha384, -sha512 처럼 해시를 지정하는 옵션을 전달해 준다.
&gt; 기본값은 -sha256 이며 openssl 1.0.2 이상이 필요

5. 제대로 생성되었는지 확인을 위해 인증서의 정보를 출력해 본다.

```bash
$ openssl x509 -text -in /etc/pki/tls/certs/lesstif-rootca.crt</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="ssl-인증서-발급">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#ssl-인증서-발급">#</doc-anchor-trigger>
        <span>SSL 인증서 발급</span>
    </h2>
</doc-anchor-target>
<p>위에서 생성한 root ca 서명키로 SSL 인증서를 발급해 보자</p>
<doc-anchor-target id="키-쌍-생성">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#키-쌍-생성">#</doc-anchor-trigger>
        <span>키 쌍 생성</span>
    </h4>
</doc-anchor-target>
<ol>
<li><p>SSL 호스트에서 사용할 RSA  key pair(public, private key) 생성</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ openssl genrsa -aes256 -out /etc/pki/tls/private/lesstif.com.key 2048</code></pre>
</doc-codeblock></div>
</li>
<li><p>Remove Passphrase from key</p>
<blockquote>
<p>개인키를 보호하기 위해 Key-Derived Function 으로 개인키 자체가 암호화되어 있다. 인터넷 뱅킹등에 사용되는 개인용 인증서는 당연히 저렇게 보호되어야 하지만 SSL 에 사용하려는 키가 암호가 걸려있으면 httpd 구동때마다 pass phrase 를 입력해야 하므로 암호를 제거한다.</p>
</blockquote>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ cp  /etc/pki/tls/private/lesstif.com.key  /etc/pki/tls/private/lesstif.com.key.enc
$ openssl rsa -in  /etc/pki/tls/private/lesstif.com.key.enc -out  /etc/pki/tls/private/lesstif.com.key</code></pre>
</doc-codeblock></div>
<blockquote>
<p>보안 경고</p>
<p>개인키의 유출 방지를 위해 group 과 other의 permission 을 모두 제거한다.</p>
<p>chmod 600  /etc/pki/tls/private/lesstif.com.key*</p>
</blockquote>
</li>
</ol>
<doc-anchor-target id="csr-생성">
    <h4>
        <doc-anchor-trigger class="header-anchor-trigger" to="#csr-생성">#</doc-anchor-trigger>
        <span>CSR 생성</span>
    </h4>
</doc-anchor-target>
<p>CSR(Certificate Signing Request) 생성을 위한 openssl config 파일을 host_openssl.conf 로 저장</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-properties"><code v-pre class="language-properties">[ req ]
default_bits            = 2048
default_md              = sha1
default_keyfile         = lesstif-rootca.key
distinguished_name      = req_distinguished_name
extensions             = v3_user
## 인증서 요청시에도 extension 이 들어가면 authorityKeyIdentifier 를 찾지 못해 에러가 나므로 막아둔다.
## req_extensions = v3_user

[ v3_user ]
# Extensions to add to a certificate request
basicConstraints = CA:FALSE
authorityKeyIdentifier = keyid,issuer
subjectKeyIdentifier = hash
keyUsage = nonRepudiation, digitalSignature, keyEncipherment
## SSL 용 확장키 필드
extendedKeyUsage = serverAuth,clientAuth
subjectAltName          = @alt_names
[ alt_names]
## Subject AltName의 DNSName field에 SSL Host 의 도메인 이름을 적어준다.
## 멀티 도메인일 경우 *.lesstif.com 처럼 쓸 수 있다.
DNS.1   = www.lesstif.com
DNS.2   = lesstif.com
DNS.3   = *.lesstif.com

[req_distinguished_name ]
countryName                     = Country Name (2 letter code)
countryName_default             = KR
countryName_min                 = 2
countryName_max                 = 2

# 회사명 입력
organizationName              = Organization Name (eg, company)
organizationName_default      = lesstif Inc.
 
# 부서 입력
organizationalUnitName          = Organizational Unit Name (eg, section)
organizationalUnitName_default  = lesstif SSL Project
 
# SSL 서비스할 domain 명 입력
commonName                      = Common Name (eg, your name or your server's hostname)
commonName_default             = lesstif.com
commonName_max                  = 64</code></pre>
</doc-codeblock></div>
<p>인증서 발급 요청(CSR) 생성</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ openssl req -new -key /etc/pki/tls/private/lesstif.com.key -out /etc/pki/tls/certs/lesstif.com.csr -config host_openssl.conf</code></pre>
</doc-codeblock></div>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter '.', the field will be left blank.

Country Name (2 letter code) [KR]:
Organization Name (eg, company) [lesstif Inc]:lesstif's Self Signed CA
Common Name (eg, your name or your servers hostname) [lesstif.com]:*.lesstif.com</code></pre>
</doc-codeblock></div>
<p>5년짜리 lesstif.com 용 SSL 인증서 발급 (서명시 ROOT CA 개인키로 서명)</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ openssl x509 -req -days 1825 -extensions v3_user -in /etc/pki/tls/certs/lesstif.com.csr \
-CA /etc/pki/tls/certs/lesstif-rootca.crt -CAcreateserial \
-CAkey  /etc/pki/tls/private/lesstif-rootca.key \
-out /etc/pki/tls/certs/lesstif.com.crt  -extfile host_openssl.conf</code></pre>
</doc-codeblock></div>
<p>제대로 생성되었는지 확인을 위해 인증서의 정보를 출력해 본다.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ openssl x509 -text -in /etc/pki/tls/certs/lesstif.com.crt</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="easy-rsa-로-인증-기관cacertificate-authority-구성하고-인증서-발급하기">
    <h1>
        <doc-anchor-trigger class="header-anchor-trigger" to="#easy-rsa-로-인증-기관cacertificate-authority-구성하고-인증서-발급하기">#</doc-anchor-trigger>
        <span>easy rsa 로 인증 기관(CA;Certificate Authority) 구성하고 인증서 발급하기</span>
    </h1>
</doc-anchor-target>
<p>Easy RSA 는 OpenVPN 프로젝트에서 사용하기 위해 만든 하위 프로젝트로 인증 기관 구축(CA; Certificate Authority) 유틸리티입니다.</p>
<p>OpenSSL 로 CA 를 구성하려면 복잡한 여러 설정이 필요하지만 easy rsa 를 사용하면 간단하게 CA 를 구성하고 인증서를 발급할 수 있습니다.</p>
<doc-anchor-target id="설치-1">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#설치-1">#</doc-anchor-trigger>
        <span>설치</span>
    </h2>
</doc-anchor-target>
<p>easy rsa 는 OpenSSL 을 쉽게 사용하기 위한 script 이므로 OpenSSL 이 설치되어 있어야 합니다. 일반적인 리눅스 배포판이라면 기본적으로 openssl 이 설치되어 있지만 혹시 없는 경우 다음 명령어로 설치하면 됩니다.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ sudo yum install openssl</code></pre>
</doc-codeblock></div>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ sudo apt install openssl</code></pre>
</doc-codeblock></div>
<p>OpenSSL 이 준비되었으면 <a href="https://github.com/OpenVPN/easy-rsa/releases">github 의 easy rsa 프로젝트에 연결</a> 한 후에 Release 를 클릭합니다.</p>
<p>패키지 목록에서 OS 에 맞는 패키지를 다운로드 받고 압축을 풀면 되며 또는 커맨드에서 다음 명령을 실행해도 됩니다.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ wget https://github.com/OpenVPN/easy-rsa/releases/download/v3.0.8/EasyRSA-3.0.8.tgz</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="사용">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#사용">#</doc-anchor-trigger>
        <span>사용</span>
    </h2>
</doc-anchor-target>
<doc-anchor-target id="ca-초기화">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#ca-초기화">#</doc-anchor-trigger>
        <span>CA 초기화</span>
    </h3>
</doc-anchor-target>
<p>먼저 init-pki 명령으로 PKI 초기화를 해줍니다. easy-rsa 하위에 pki 폴더가 생기고 이 안에 새로운 인증서가 생성됩니다.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$./easyrsa init-pki

init-pki complete; you may now create a CA or requests.
Your newly created PKI dir is: /home/lesstif/Downloads/EasyRSA-3.0.8/pki</code></pre>
</doc-codeblock></div>
<p>build-ca 명령으로 CA 를 구성합니다. 먼저 CA 개인키의 pass phrase 를 묻는데 잊어버리면 CA 를 새로 만들어야 하므로 입력해 주고 잊지 않게 기억해 둡니다.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ ./easyrsa build-ca

Using SSL: openssl OpenSSL 1.1.1j  FIPS 16 Feb 2021

Enter New CA Key Passphrase: 
Re-Enter New CA Key Passphrase: 
Generating RSA private key, 2048 bit long modulus (2 primes)</code></pre>
</doc-codeblock></div>
<p>pass phrase 입력이 끝나면 2048 비트의 RSA 키를 생성합니다.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">e is 65537 (0x010001)
You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter '.', the field will be left blank.

Common Name (eg: your user, host, or server name) [Easy-RSA CA]:lesstif CA      </code></pre>
</doc-codeblock></div>
<p>이제 CA 인증서의 common name 을 설정해야 하는데 서버 이름이나 host 이름등을 입력해 주면 됩니다. 저는 &quot;lesstif CA&quot; 를 입력했습니다.</p>
<p>입력이 끝나면 CA 개인키와 인증서가 pki 폴더밑에 생성되고 인증서 발급 준비가 완료됩니다.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">CA creation complete and you may now import and sign cert requests.
Your new CA certificate file for publishing is at:
/home/lesstif/Downloads/EasyRSA-3.0.8/pki/ca.crt</code></pre>
</doc-codeblock></div>
<doc-anchor-target id="인증서-서명--요청-생성client">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#인증서-서명--요청-생성client">#</doc-anchor-trigger>
        <span>인증서 서명  요청 생성(Client)</span>
    </h3>
</doc-anchor-target>
<p>인증서가 필요한 client 에서는 인증서 서명 요청(CSR; Certificate signing request)을 생성한후에 CA 에 전달해 주면 CA 가 개인키(private key) 로 전자서명한 것이 인증서입니다.</p>
<p>요청 측에서도 공개 키쌍 생성을 해야 하므로 init-pki 로 초기화를 해줍니다.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ ./easyrsa init-pki</code></pre>
</doc-codeblock></div>
<p>이제 gen-req 명령뒤에 서버 이름을 옵션으로 전달해서 CSR 을 생성합니다.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ ./easyrsa gen-req LesstifWebServer

Using SSL: openssl OpenSSL 1.1.1j  FIPS 16 Feb 2021
Generating a RSA private key
......+++++
...............................+++++
writing new private key to '/home/user/EasyRSA-3.0.8/pki/easy-rsa-34188.6cwDro/tmp.Gp67YQ'
Enter PEM pass phrase:
Verifying - Enter PEM pass phrase:</code></pre>
</doc-codeblock></div>
<p>pass phrase 를 입력하면 개인 키와 공개 키가 생성되고 발급 요청자의 common name 을 입력하라고 하며 자동으로 gen-req 뒤에 준 옵션으로 설정됩니다.</p>
<p>보통 서버 이름을 입력하며 저는 lesstifWebServer 로 설정했습니다.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">
You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter '.', the field will be left blank.

Common Name (eg: your user, host, or server name) [LesstifWebServer]: LesstifWebServer</code></pre>
</doc-codeblock></div>
<p>키 쌍과 req가 생성되었다는 메시지가 출력되는데 req 는 CSR 로 인증기관(CA) 에 전달해 주면 CA 가 CSR 을 받아서 요청자의 공개 키를 꺼내고 여러 정보를 조합한 후에 CA의 개인키로 전자서명해 주는데 이게 바로 인증서입니다.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">Keypair and certificate request completed. Your files are:
req: /home/user1/EasyRSA-3.0.8/pki/reqs/LesstifWebServer.req
key: /home/user1/EasyRSA-3.0.8/pki/private/LesstifWebServer.key</code></pre>
</doc-codeblock></div>
<p>그러므로 생성된 req 인 /home/user1/EasyRSA-3.0.8/pki/reqs/LesstifWebServer.req 를 인증기관에 전달해 주면 됩니다</p>
<doc-anchor-target id="인증서-발급ca">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#인증서-발급ca">#</doc-anchor-trigger>
        <span>인증서 발급(CA)</span>
    </h3>
</doc-anchor-target>
<p>CA 는 req 파일을 받아서 import-req 명령으로 인증서를 발급해 주면 됩니다. 이때 Client 가 생성한 req 파일의 절대 경로를 입력해야 합니다.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$./easyrsa import-req /home/user1/EasyRSA-3.0.8/pki/reqs/LesstifWebServer.req LesstifWebServer

Using SSL: openssl OpenSSL 1.1.1j  FIPS 16 Feb 2021

The request has been successfully imported with a short name of: LesstifWebServer
You may now use this name to perform signing operations on this request.</code></pre>
</doc-codeblock></div>
<p>성공적으로 import 가 되었다는 메시지가 표시되면 이제 CA 개인키로 서명해서 인증서를 발급해 주면 됩니다.</p>
<p>명령은 sign-req 이며 뒤에 옵션으로 client 와 위에서 전달받은 CSR 내 common name을 입력합니다.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">$ ./easyrsa sign-req client LesstifWebServer
Using SSL: openssl OpenSSL 1.1.1j  FIPS 16 Feb 2021


You are about to sign the following certificate.
Please check over the details shown below for accuracy. Note that this request
has not been cryptographically verified. Please be sure it came from a trusted
source or that you have verified the request checksum with the sender.

Request subject, to be signed as a client certificate for 825 days:

subject=
    commonName                = LesstifWebServer


Type the word 'yes' to continue, or any other input to abort.
  Confirm request details: </code></pre>
</doc-codeblock></div>
<p>commonName 확인 창이 뜨면 yes 를 입력합니다.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">Using configuration from /home/lesstif/Downloads/EasyRSA-3.0.8/pki/easy-rsa-36037.BzVS1I/tmp.egTrHW
Enter pass phrase for /home/lesstif/Downloads/EasyRSA-3.0.8/pki/private/ca.key:</code></pre>
</doc-codeblock></div>
<p>CA 개인 키의 pass phrase 를 묻는 창에 제대로 입력이 되면 pki/issued 폴더에 common name 이름이 붙은 인증서가 발급됩니다. 발급된 인증서를 CSR 을 보낸 client 에 전달해 주면 됩니다.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre class="language-bash"><code v-pre class="language-bash">Check that the request matches the signature
Signature ok
The Subject's Distinguished Name is as follows
commonName            :ASN.1 12:'LesstifWebServer'
Certificate is to be certified until Jun 17 06:49:41 2023 GMT (825 days)

Write out database with 1 new entries
Data Base Updated

Certificate created at: /home/lesstif/Downloads/EasyRSA-3.0.8/pki/issued/LesstifWebServer.crt</code></pre>
</doc-codeblock></div>




                <!-- Required only on API pages -->
                <doc-toolbar-member-filter-no-results />
            </div>

            
<nav class="flex mt-14">
    <div class="w-1/2">
        <a class="px-5 py-4 h-full flex items-center break-all md:break-normal font-medium text-blue-500 dark:text-blue-400 border border-gray-300 hover:border-gray-400 dark:border-dark-650 dark:hover:border-dark-450 rounded-l-lg transition-colors duration-150 relative hover:z-5" href="/TestPrivatePages/keytool-import-privatekey-certificate/">
            <svg xmlns="http://www.w3.org/2000/svg" class="mr-3" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M19 11H7.41l5.29-5.29a.996.996 0 10-1.41-1.41l-7 7a1 1 0 000 1.42l7 7a1.024 1.024 0 001.42-.01.996.996 0 000-1.41L7.41 13H19c.55 0 1-.45 1-1s-.45-1-1-1z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
            <span>
                <span class="block text-xs font-normal text-gray-400 dark:text-dark-400">Previous</span>
                <span class="block mt-1">KeyTool Import PrivateKey, Certificate</span>
            </span>
        </a>
    </div>

    <div class="w-1/2">
        <a class="px-5 py-4 -mx-px h-full flex items-center justify-end break-all md:break-normal font-medium text-blue-500 dark:text-blue-400 border border-gray-300 hover:border-gray-400 dark:border-dark-650 dark:hover:border-dark-450 rounded-r-lg transition-colors duration-150 relative hover:z-5" href="/TestPrivatePages/crypto-file-format/">
            <span>
                <span class="block text-xs font-normal text-right text-gray-400 dark:text-dark-400">Next</span>
                <span class="block mt-1">PEM 과 CER/DER/CRT/CSR 형식 파일이란?</span>
            </span>
            <svg xmlns="http://www.w3.org/2000/svg" class="ml-3" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" overflow="visible"><path d="M19.92 12.38a1 1 0 00-.22-1.09l-7-7a.996.996 0 10-1.41 1.41l5.3 5.3H5c-.55 0-1 .45-1 1s.45 1 1 1h11.59l-5.29 5.29a.996.996 0 000 1.41c.19.2.44.3.7.3s.51-.1.71-.29l7-7c.09-.09.16-.21.21-.33z" /><path fill="none" d="M0 0h24v24H0z" /></svg>
        </a>
    </div>
</nav>


        </main>

        <div class="border-t dark:border-dark-650 pt-6 mb-8">
            <footer class="flex flex-wrap items-center justify-between">
    <div>
        <ul class="flex flex-wrap items-center text-sm">
</ul>

    </div>
    <div class="docs-copyright py-2 text-gray-500 dark:text-dark-350 text-sm leading-relaxed"><p>© Copyright 2021. All rights reserved.</p>
</div>
</footer>

        </div>
    </div>
    
    <!-- Rendered if sidebar right is enabled -->
    <!-- Sidebar right skeleton-->
    <div v-cloak class="fixed top-0 bottom-0 right-0 transform translate-x-full bg-white border-gray-200 lg:sticky lg:border-l lg:flex-shrink-0 lg:pt-6 lg:transform-none lg:w-56 lg:z-0 md:w-72 sidebar-right skeleton dark:bg-dark-850 dark:border-dark-650">
        <div class="pl-5">
            <div class="w-32 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
            <div class="w-48 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
            <div class="w-40 h-3 mb-4 bg-gray-200 dark:bg-dark-600 rounded-full loading"></div>
        </div>
    </div>
    
    <!-- User should be able to hide sidebar right -->
    <doc-sidebar-right v-cloak></doc-sidebar-right>
</div>

        </div>
    </div>

    <doc-search-mobile></doc-search-mobile>
    <doc-back-to-top></doc-back-to-top>
</div>


        <div id="docs-overlay-target"></div>

        <script>window.__DOCS__ = { "title": "OpenSSL", icon: "file", hasPrism: true, hasMermaid: false, hasMath: false }</script>
    </body>
</html>
